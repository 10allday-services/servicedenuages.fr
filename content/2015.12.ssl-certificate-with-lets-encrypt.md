Title: Comment configurer un certificat SSL avec Let's Encrypt
Lang: fr
Url: configurer-un-certificat-ssl-lets-encrypt
Slug: ssl-certificate-with-lets-encrypt
Date: 2015-12-16
Summary: Un description de la procédure à suivre pour utiliser un certificat SSL validé par Let's Encrypt.

Fini les certificats non sécurisés et très coûteux, avec Let's Encrypt
vous n'avez plus d'excuse car il vous est possible d'obtenir un
certificat SSL valide sur tous les navigateurs, gratuitement et sans
avoir besoin d'être un expert en cryptographie.

# Serveur dédié

Si vous avez la chance d'avoir un serveur dédié, c'est complètement
automatique et il vous suffit de suivre les instructions sur [le site
de Let's Encrypt](https://letsencrypt.org/howitworks/).

# Serveur mutualisé

Sur un serveur mutualisé c'est un peu moins automatique car il faut
ajouter manuellement la preuve de possession du serveur en hébergeant
un fichier dessus avant de pouvoir signer le certificat.

Il vous faudra aussi récupèrer les différents fichiers pour les faire
parvenir à votre hébergeur.

Voici ci-dessous la procédure à suivre sur votre ordinateur.

## Téléchargez le client sur votre ordinateur

https://letsencrypt.org/howitworks/#installing-lets-encrypt

    $ git clone https://github.com/letsencrypt/letsencrypt
    $ cd letsencrypt


## Lancez le script automatique

    $ ./letsencrypt-auto certonly --manual -d mondomaine.fr -d www.mondomaine.fr


## Mettez en ligne la preuve que le domaine est bien à vous

En utilisant votre client FTP vous pouvez:

Créez le répertoire : `www/.well-known/acme-challenge/`
Créez le fichier dont le nom et le contenu vous est donné.

Par exemple:

    $ mkdir .well-known/acme-challenge/
    $ cat > .well-known/acme-challenge/1ni92R95ooeCPOcRhVXYSF1HXVfdS61uWMlMjQXOQns
    1ni92R95ooeCPOcRhVXYSF1HXVfdS61uWMlMjQXOQns.MJvFiRCK_M0WiBPW19A7VQekVtY5sSojwa44TFcaUAw

Vérifiez que vous pouvez bien accéder au lien qui vous est donné :
https://www.mondomaine.com/.well-known/acme-challenge/1ni92R95ooeCPOcRhVXYSF1HXVfdS61uWMlMjQXOQns

Ensuite appuyez sur *Entrée*


## Mettrez en ligne votre certificat

Vous devez ensuite vous rendre dans l'interface de votre hébergeur et
renseigner le contenu des fichiers `privkey.pem`, `cert.pem` et
`fullchain.pem` dans le champ de formulaire respectifs `Clé privé`,
`Certificat`, `Certificats intermédiaires` qui ont été créé pour vous
dans le répertoire : `/etc/letsencrypt/live/mondomaine.com`


## Que faire ensuite ?

Votre certificat est valable pour 3 mois n'oubliez pas de vous mettre
un réveil quelques jours avant sa date d'expiration pour relancer
votre script et mettre à jour le certificat. Les fichiers
`fullchain.pem` et `privkey.pem` resteront inchangés mais le fichier
`cert.pem` doit être mis à jour.

Pour se faire relancer la commande sur le même ordinateur:

    $ ./letsencrypt-auto certonly --manual -d mondomaine.fr -d www.mondomaine.fr

Un écran s'affiche vous proposant de renouveler le certificat.

Suivez la procédure et mettez à jour le certificat dans l'interface de
votre hébergeur.


## Conclusion

Let's Encrypt facilite vraiment la vie, plus besoin de généré un CSR,
plus besoin de payer, plus besoin de se creuser la tête pour chaque
certificat, vous pouvez mettre autant de sous domaines que vous le
souhaitez et régénerer votre certificat jusqu'à 5 fois par semaines si
nécessaire.

La seule chose à faire c'est de mettre à jour son certificat SSL tous
les 3 mois en relançant la commande.

La procédure de mise en place étant disponible et le client étant Open
Source il y a fort à parié que les hébergeurs vont simplifié la
procédure et la rendre spécifique à leur interface d'administration.

Des serveurs HTTP tels que ``caddy`` ont déjà
[intégré la génération du certificat](https://www.youtube.com/watch?v=nk4EWHvvZtI)
dans la procédure d'installation de leur serveur.
